---
title: 数据统一的匹配条件
description: 匹配实体以创建统一客户配置文件。
recommendations: false
ms.date: 10/07/2022
ms.subservice: audience-insights
ms.topic: tutorial
author: v-wendysmith
ms.author: mukeshpo
ms.reviewer: v-wendysmith
manager: shellyha
searchScope:
- ci-match
- ci-merge
- ci-map
- customerInsights
ms.openlocfilehash: bbd2c5f441b85460250c11f02358ea67260278d6
ms.sourcegitcommit: 52ea58c872b10f1e6f9d120be93df93cca1a12dd
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/26/2022
ms.locfileid: "9721510"
---
# <a name="match-conditions-for-data-unification"></a>数据统一的匹配条件

统一中的此步骤定义跨实体匹配的匹配顺序和规则。 此步骤至少需要两个实体。

> [!NOTE]
> 创建匹配条件并选择 **下一步** 后，您无法删除选定的实体或属性。 如果需要，请选择 **返回** 以在继续之前查看所选实体和属性。

[!INCLUDE [m3-first-run-note](includes/m3-first-run-note.md)]

## <a name="include-enriched-entities-preview"></a>包括扩充的实体（预览版）

如果您在数据源级别扩充了实体以帮助改进统一结果，请选择它们。 有关详细信息，请参阅[数据源扩充](data-sources-enrichment.md)。 如果在 **重复记录** 页上选择了扩充的实体，则不需要再次选择这些实体。

1. 在 **匹配条件** 页上，选择页面顶部的 **使用扩充的实体**。

1. 从 **使用已扩充实体** 窗格中，选择一个或多个扩充的实体。

1. 选择 **完成**。

## <a name="specify-the-match-order"></a>指定匹配顺序

每个匹配将两个或多个实体统一为一个合并实体。 同时，它将保留唯一的客户记录。 匹配顺序表示系统尝试匹配记录的顺序。

> [!IMPORTANT]
> 第一个实体称为主要实体，它是统一配置文件的基础。 所选的其他实体将添加到此实体中。
>
> 重要考虑因素。
>
> - 选择具有关于客户的最完整和最可靠的个人资料数据的实体作为主要实体。
> - 选择与其他实体一样具有多个属性（例如，姓名、电话号码或电子邮件地址）的实体作为主要实体。

1. 在 **匹配条件** 页上，使用向上和向下箭头按需要的顺序移动实体，或拖放实体。 例如，选择 **eCommerceCustomers** 作为主要实体，选择 **loyCustomers** 作为第二个实体。

1. 如果要将实体中的每条记录作为唯一客户而且不考虑是否找到匹配项，请选择 **包括所有记录**。 此实体中与任何其他实体中的记录不匹配的任何记录都包含在统一配置文件中。 没有匹配项的记录称为单一实例。
  
主要实体 *Contacts:eCommerce* 与下一个实体 *CustomerLoyalty:Loyalty* 匹配。 如果您有两个以上的实体，则第一个匹配步骤产生的数据集会与以下实体匹配。

:::image type="content" source="media/m3_match.png" alt-text="为实体选择的匹配顺序的屏幕截图。" lightbox="media/m3_match.png":::

## <a name="define-rules-for-match-pairs"></a>定义匹配对的规则

匹配规则指定匹配一对特定实体时所用逻辑。 规则由一个或多个条件组成。

实体名称旁边的警告表示没有为匹配对定义匹配规则。

1. 为实体对选择 **添加规则** 以定义匹配规则。

1. 在 **添加规则** 窗格中，配置规则的条件。

   :::image type="content" source="media/m3_add_rule.png" alt-text="“添加规则”窗格的屏幕截图。":::

   - **选择实体/字段（第一行）**：选择客户可能独有的实体和属性。 例如，电话号码或电子邮件地址。 避免按活动-类型属性进行匹配。 例如，购买 ID 可能在其他记录类型中找不到匹配项。

   - **选择实体/字段（第二行）**：选择与第一行中指定的实体属性相关的属性。

   - **标准化**：为所选属性从以下标准化选项中进行选择。
     - **数字**：将其他数字系统（如罗马数字）转换为阿拉伯语数字。 *VIII* 将变为 *8*。
     - **符号**：删除所有符号和特殊字符。 *Head&Shoulder* 会变为 *HeadShoulder*。
     - **文本转换为小写**：将所有字符转换为小写。 *ALL CAPS and Title Case* 将变为 *all caps and title case*。
     - **类型（电话、名称、地址、组织）**：对名称、头衔、电话号码、地址和组织等进行标准化处理。
     - **Unicode 转变为 ASCII**：将 Unicode 表示法转换为 ASCII 字符。 */u00B2* 将变为 *2*。
     - **空白**：删除所有空格。 *Hello   World* 会变为 *HelloWorld*。

   - **精度**：设置要用于此条件的精度级别。
     - **基本**：从 *低 (30%)*、*中 (60%)*、*高 (80%)* 和 *精确 (100%)* 中选择。 选择 **精确** 以仅匹配 100% 匹配的记录。
     - **自定义**：设置记录需要匹配的百分比。 系统将只匹配传递此阈值的记录。

   - **名称**：规则的名称。

1. 若要仅在属性满足多个条件时匹配实体，请选择 **添加** > **添加条件**，以向匹配规则添加更多条件。 条件与逻辑 AND 运算符相连，因此仅在满足所有条件时才会执行。

1. 或者，也可以考虑高级选项，例如[异常](#add-exceptions-to-a-rule)或[自定义匹配条件](#specify-custom-match-conditions)。

1. 选择 **完成** 以完成规则。

1. （可选）[添加更多规则](#add-rules-to-a-match-pair)。

1. 单击 **下一步**。

> [!div class="nextstepaction"]
> [下一步：统一字段](merge-entities.md)

### <a name="add-rules-to-a-match-pair"></a>向匹配对中添加规则

匹配规则表示条件集。 要根据多个属性按条件匹配实体，请添加更多规则。

1. 针对要添加规则的实体选择 **添加规则**。

1. 按照[定义匹配对的规则](#define-rules-for-match-pairs)中的步骤操作。

> [!NOTE]
> 规则的顺序很重要。 匹配算法会根据您的第一条规则尝试匹配给定的客户记录，并且仅当没有与第一条规则匹配时才继续执行第二条规则。

## <a name="advanced-options"></a>高级选项

### <a name="add-exceptions-to-a-rule"></a>添加规则例外

在大多数情况下，实体匹配会产生具有合并数据的唯一客户配置文件。 要处理极少数情况下的误报和漏报，为匹配规则定义例外。 在处理完匹配规则后应用例外，并避免匹配所有满足例外条件的记录。

例如，如果您的匹配规则结合了姓氏、城市和出生日期，则系统会将居住在同一城镇且姓氏相同的双胞胎识别为同一配置文件。 如果您组合的实体中的名字不同，您可以指定一个与配置文件不匹配的例外。

1. 在 **编辑规则** 窗格中，选择 **添加** > **添加例外**。

1. 指定例外条件。

1. 选择 **完成** 保存规则。

### <a name="specify-custom-match-conditions"></a>指定自定义匹配条件

指定替代默认匹配逻辑的条件。 可使用以下四个选项：

|选项  |说明  |示例  |
|---------|---------|---------|
|始终匹配     | 为始终匹配的主键定义值。         |  始终将主键 *12345* 的行与主键 *54321* 的行匹配。       |
|从不匹配     | 为从不匹配的主键定义值。        | 永远不会将主键 *12345* 的行与主键 *54321* 的行匹配。        |
|绕过            | 定义匹配阶段中系统应始终忽略的值。 |  匹配期间忽略值 *11111* 和 *未知*。        |
|别名映射    | 定义系统应视为相同值的值。         | 认为 *Joe* 等同于 *Joseph*。        |

1. 选择 **自定义**。

   :::image type="content" source="media/m3_match_custom.png" alt-text="自定义按钮":::

1. 选择 **自定义类型** 并选择 **下载模板**。 重命名模板，不要使用空格。 为每个匹配选项使用单独的模板。

1. 打开下载的模板文件并填写详细信息。 此模板中包含用于指定实体的字段和要在自定义匹配中使用的实体主键值。 实体名称区分大小写。 例如，如果您希望 *销售* 实体中的主键 *12345* 始终与 *联系人* 实体中的主键 *34567* 匹配，则填写以下模板：
   - 实体 1：销售
   - 实体 1 键：12345
   - 实体 2：联系人
   - 实体 2 键：34567

   同一个模板文件可以指定多个实体的自定义匹配记录。

   > [!NOTE]
   > 如果要为实体上的删除重复操作指定自定义匹配，请提供与 Entity1 和 Entity2 相同的实体，并设置不同的主键值。 要使用自定义匹配，必须至少为实体定义一个删除重复项规则。

1. 添加所有替代项之后，保存模板文件。

1. 转到 **数据** > **数据源** 并将模板文件作为新实体引入。

1. 上传文件后，再次选择 **自定义** 选项。 从下拉菜单中选择所需的实体，然后选择 **完成**。

   :::image type="content" source="media/custom-match-overrides.png" alt-text="用于选择自定义匹配方案替代的对话框的屏幕截图。":::

1. 应用自定义匹配的操作取决于您使用的匹配选项。

   - 对于 **始终匹配** 或 **从不匹配**，请继续下一步。
   - 对于 **绕过** 或 **别名映射**，请对现有匹配规则选择 **编辑** 或创建新规则。 在“规范化”下拉列表中，选择 **自定义绕过** 或 **别名映射** 选项，然后选择 **完成**。

1. 在 **自定义** 窗格上选择 **完成** 以应用自定义匹配配置。

   引入的每个模板文件都是其自己的数据源。 如果发现需要特殊匹配处理的记录，更新相应的数据源。 更新将在下一个统一过程中使用。 例如，您确定了住在同一个地址的名字几乎相同的双胞胎，而这个地址已经合并为一个人。 这时应更新数据源以将双胞胎识别为单独的唯一记录。

> [!div class="nextstepaction"]
> [下一步：统一字段](merge-entities.md)

[!INCLUDE [footer-include](includes/footer-banner.md)]
